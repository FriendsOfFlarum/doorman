{"version":3,"sources":["webpack://@reflar/doorman/webpack/bootstrap","webpack://@reflar/doorman/./admin.js","webpack://@reflar/doorman/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@reflar/doorman/./src/admin/addSettingsPage.js","webpack://@reflar/doorman/./src/admin/components/DoormanSettingsListItem.js","webpack://@reflar/doorman/./src/admin/components/InviteCodeModal.js","webpack://@reflar/doorman/./src/admin/components/SettingsPage.js","webpack://@reflar/doorman/./src/admin/index.js","webpack://@reflar/doorman/./src/admin/models/Doorkey.js","webpack://@reflar/doorman/external \"flarum.core.compat['Component']\"","webpack://@reflar/doorman/external \"flarum.core.compat['Model']\"","webpack://@reflar/doorman/external \"flarum.core.compat['app']\"","webpack://@reflar/doorman/external \"flarum.core.compat['components/AdminLinkButton']\"","webpack://@reflar/doorman/external \"flarum.core.compat['components/AdminNav']\"","webpack://@reflar/doorman/external \"flarum.core.compat['components/Alert']\"","webpack://@reflar/doorman/external \"flarum.core.compat['components/Badge']\"","webpack://@reflar/doorman/external \"flarum.core.compat['components/Button']\"","webpack://@reflar/doorman/external \"flarum.core.compat['components/LoadingIndicator']\"","webpack://@reflar/doorman/external \"flarum.core.compat['components/Modal']\"","webpack://@reflar/doorman/external \"flarum.core.compat['components/Page']\"","webpack://@reflar/doorman/external \"flarum.core.compat['components/Select']\"","webpack://@reflar/doorman/external \"flarum.core.compat['components/Switch']\"","webpack://@reflar/doorman/external \"flarum.core.compat['extend']\"","webpack://@reflar/doorman/external \"flarum.core.compat['utils/Stream']\"","webpack://@reflar/doorman/external \"flarum.core.compat['utils/mixin']\"","webpack://@reflar/doorman/external \"flarum.core.compat['utils/saveSettings']\"","webpack://@reflar/doorman/external \"flarum.core.compat['utils/withAttr']\""],"names":["app","routes","path","component","SettingsPage","extensionSettings","m","route","get","extend","AdminNav","prototype","items","add","AdminLinkButton","href","icon","description","translator","trans","DoormanSettingsListItem","view","doorkey","attrs","doorkeys","remaining","maxUses","uses","key","withAttr","updateKey","bind","Select","options","getGroupsForInput","className","onchange","updateGroupId","value","groupId","updateMaxUses","Switch","state","activates","updateActivates","Button","type","onclick","showModal","deleteDoorkey","Badge","label","transChoice","join","modal","show","InviteCodeModal","oncreate","vnode","$","tooltip","container","store","all","map","group","nameSingular","id","save","doorkeyToDelete","delete","some","i","data","splice","Component","oninit","emails","success","title","off","on","e","keyCode","preventDefault","addEmails","content","getById","loading","email","removeEmail","send","disabled","length","alert","redraw","badEmails","val","split","includes","attributes","validateEmail","push","re","test","String","toLowerCase","request","method","url","forum","attribute","body","doorkeyId","then","close","alerts","Modal","DoormanSettingsPage","switcherLoading","isOptional","settings","Stream","generateRandomKey","createDoorkey","toggleOptional","Array","Math","random","toString","slice","createRecord","JSON","stringify","saveSettings","parse","catch","Page","initializers","models","Doorkey","addSettingsPage","apiEndpoint","exists","mixin","Model"],"mappings":"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","file":"admin.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./admin.js\");\n","export * from './src/admin';\r\n","export default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}","import { extend } from 'flarum/extend';\nimport AdminNav from 'flarum/components/AdminNav';\nimport AdminLinkButton from 'flarum/components/AdminLinkButton';\nimport SettingsPage from './components/SettingsPage';\n\nexport default function () {\n    app.routes['reflar-doorman'] = {\n        path: '/reflar/doorman',\n        component: SettingsPage,\n    };\n\n    app.extensionSettings['reflar-doorman'] = () => m.route.get(app.route('reflar-doorman'));\n\n    extend(AdminNav.prototype, 'items', (items) => {\n        items.add(\n            'reflar-doorman',\n            AdminLinkButton.component(\n                {\n                    href: app.route('reflar-doorman'),\n                    icon: 'fa fa-door-closed',\n                    description: app.translator.trans('fof-doorman.admin.nav.desc'),\n                },\n                'Doorman'\n            )\n        );\n    });\n}\n","import Component from 'flarum/Component';\nimport Button from 'flarum/components/Button';\nimport Badge from 'flarum/components/Badge';\nimport Select from 'flarum/components/Select';\nimport Switch from 'flarum/components/Switch';\nimport InviteCodeModal from './InviteCodeModal';\nimport withAttr from 'flarum/utils/withAttr';\n\nexport default class DoormanSettingsListItem extends Component {\n    view() {\n        this.doorkey = this.attrs.doorkey;\n        this.doorkeys = this.attrs.doorkeys;\n\n        var remaining = this.doorkey.maxUses() - this.doorkey.uses();\n\n        return (\n            <div className=\"DoormanSettingsListItem\">\n                <div className=\"DoormanSettingsListItem-inputs\">\n                    <input\n                        className=\"FormControl Doorkey-key\"\n                        type=\"text\"\n                        disabled\n                        value={this.doorkey.key()}\n                        placeholder={app.translator.trans('fof-doorman.admin.page.doorkey.key')}\n                        onchange={withAttr('value', this.updateKey.bind(this, this.doorkey))}\n                    />\n                    {Select.component({\n                        options: this.getGroupsForInput(),\n                        className: 'Doorkey-select',\n                        onchange: this.updateGroupId.bind(this, this.doorkey),\n                        value: this.doorkey.groupId() || 3,\n                    })}\n                    <input\n                        className=\"FormControl Doorkey-maxUses\"\n                        value={this.doorkey.maxUses() || '0'}\n                        type=\"number\"\n                        placeholder={app.translator.trans('fof-doorman.admin.page.doorkey.max_uses')}\n                        onchange={withAttr('value', this.updateMaxUses.bind(this, this.doorkey))}\n                    />\n                    {Switch.component({\n                        state: this.doorkey.activates() || false,\n                        onchange: this.updateActivates.bind(this, this.doorkey),\n                        className: 'Doorkey-switch',\n                    })}\n                </div>\n\n                {Button.component({\n                    type: 'button',\n                    className: 'Button Button--warning Doorkey-button',\n                    icon: 'fa fa-envelope',\n                    onclick: this.showModal.bind(this),\n                })}\n\n                {Button.component({\n                    type: 'button',\n                    className: 'Button Button--warning Doorkey-button',\n                    icon: 'fa fa-times',\n                    onclick: this.deleteDoorkey.bind(this, this.doorkey),\n                })}\n\n                {this.doorkey.maxUses() === this.doorkey.uses() ? (\n                    Badge.component({\n                        className: 'Doorkey-badge',\n                        icon: 'fas fa-user-slash',\n                        label: app.translator.trans('fof-doorman.admin.page.doorkey.warning'),\n                    })\n                ) : this.doorkey.uses() !== 0 ? (\n                    <div>\n                        <h3 className=\"Doorkey-left\">\n                            {app.translator.transChoice('fof-doorman.admin.page.doorkey.used_times', remaining, { remaining }).join('')}\n                        </h3>\n                    </div>\n                ) : (\n                    ''\n                )}\n            </div>\n        );\n    }\n\n    showModal() {\n        app.modal.show(InviteCodeModal, { doorkey: this.doorkey });\n    }\n\n    oncreate(vnode) {\n        $('.fa-exclamation-cricle').tooltip({ container: 'body' });\n    }\n\n    getGroupsForInput() {\n        let options = [];\n\n        app.store.all('groups').map((group) => {\n            if (group.nameSingular() === 'Guest') {\n                return;\n            }\n            options[group.id()] = group.nameSingular();\n        });\n\n        return options;\n    }\n\n    updateKey(doorkey, key) {\n        doorkey.save({ key });\n    }\n\n    updateGroupId(doorkey, groupId) {\n        doorkey.save({ groupId });\n    }\n\n    updateMaxUses(doorkey, maxUses) {\n        doorkey.save({ maxUses });\n    }\n\n    updateActivates(doorkey, activates) {\n        doorkey.save({ activates });\n    }\n\n    deleteDoorkey(doorkeyToDelete) {\n        doorkeyToDelete.delete();\n        this.doorkeys.some((doorkey, i) => {\n            if (doorkey.data.id === doorkeyToDelete.data.id) {\n                this.doorkeys.splice(i, 1);\n                return true;\n            }\n        });\n    }\n}\n","import Alert from 'flarum/components/Alert';\nimport Modal from 'flarum/components/Modal';\nimport Button from 'flarum/components/Button';\n\nexport default class InviteCodeModal extends Modal {\n    oninit(vnode) {\n        super.oninit(vnode);\n\n        this.emails = [];\n\n        this.doorkey = this.attrs.doorkey;\n\n        this.success = false;\n    }\n\n    className() {\n        return 'InviteCodeModal Modal--small';\n    }\n\n    title() {\n        return app.translator.trans('fof-doorman.admin.modal.title');\n    }\n\n    oncreate(vnode) {\n        super.oncreate(vnode);\n        $('#EmailInput')\n            .off()\n            .on('keydown', (e) => {\n                if (e.keyCode === 13 || e.keyCode === 188 || e.keyCode === 32) {\n                    e.preventDefault();\n                    this.addEmails();\n                }\n            });\n    }\n\n    content() {\n        return (\n            <div className=\"Modal-body\">\n                <h3>\n                    {app.translator.trans('fof-doorman.admin.modal.group', {\n                        group: app.store.getById('groups', this.doorkey.groupId()).nameSingular(),\n                    })}\n                </h3>\n                <div className=\"helpText\">{app.translator.trans('fof-doorman.admin.modal.help')}</div>\n                <div className=\"Form Form--centered\">\n                    <div className=\"Form-group\">\n                        <input\n                            type=\"text\"\n                            name=\"text\"\n                            id=\"EmailInput\"\n                            className=\"FormControl\"\n                            placeholder={app.translator.trans('fof-doorman.admin.modal.placeholder')}\n                            disabled={this.loading}\n                        />\n                    </div>\n                    <div className=\"Form-group\">\n                        <ul>\n                            {this.emails.map((email, i) => {\n                                return (\n                                    <li className=\"emailListItem\">\n                                        <p>{email}</p>\n                                        {Button.component({\n                                            className: 'Button',\n                                            loading: this.loading,\n                                            icon: 'fas fa-times',\n                                            onclick: this.removeEmail.bind(this, i),\n                                        })}\n                                    </li>\n                                );\n                            })}\n                        </ul>\n                    </div>\n                    <div className=\"Form-group\">\n                        {Button.component(\n                            {\n                                className: 'Button Button--primary Button--block',\n                                loading: this.loading,\n                                onclick: this.send.bind(this),\n                                disabled: this.emails.length === 0,\n                            },\n                            app.translator.trans('fof-doorman.admin.modal.send')\n                        )}\n                    </div>\n                </div>\n            </div>\n        );\n    }\n\n    addEmails() {\n        this.alert = null;\n        m.redraw();\n        this.badEmails = [];\n\n        const value = $('#EmailInput').val();\n\n        value.split(/[ ,]+/).map((email) => {\n            if (!this.emails.includes(email)) {\n                if (this.emails.length + 1 > this.doorkey.data.attributes.maxUses) {\n                    this.alert = ({ type: 'error' }, app.translator.trans('fof-doorman.admin.modal.max_use_conflict'));\n                    m.redraw();\n                } else {\n                    if (this.validateEmail(email)) {\n                        this.emails.push(email);\n                        $('#EmailInput').val('');\n                        m.redraw();\n                    } else {\n                        this.badEmails.push(email);\n                        this.alert =\n                            ({ type: 'error' },\n                            app.translator.trans('fof-doorman.admin.modal.invalid_emails', { emails: this.badEmails.join(', ') }));\n                        m.redraw();\n                    }\n                }\n            }\n        });\n    }\n\n    validateEmail(email) {\n        const re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n        return re.test(String(email).toLowerCase());\n    }\n\n    removeEmail(i) {\n        this.emails.splice(i, 1);\n    }\n\n    send(e) {\n        e.preventDefault();\n\n        this.alert = null;\n\n        this.loading = true;\n\n        app.request({\n            method: 'POST',\n            url: app.forum.attribute('apiUrl') + '/reflar/doorkeys/invites',\n            body: {\n                emails: this.emails,\n                doorkeyId: this.doorkey.data.id,\n            },\n        }).then(() => {\n            app.modal.close();\n            app.alerts.show({ type: 'success' }, app.translator.trans('fof-doorman.admin.modal.success'));\n        });\n    }\n}\n","import Page from 'flarum/components/Page';\nimport LoadingIndicator from 'flarum/components/LoadingIndicator';\nimport DoormanSettingsListItem from './DoormanSettingsListItem';\nimport Button from 'flarum/components/Button';\nimport Select from 'flarum/components/Select';\nimport Switch from 'flarum/components/Switch';\nimport app from 'flarum/app';\nimport saveSettings from 'flarum/utils/saveSettings';\nimport Stream from 'flarum/utils/Stream';\nimport withAttr from 'flarum/utils/withAttr';\n\nexport default class DoormanSettingsPage extends Page {\n    oninit(vnode) {\n        super.oninit(vnode);\n\n        this.loading = false;\n        this.switcherLoading = false;\n        this.doorkeys = app.store.all('doorkeys');\n        this.isOptional = app.data.settings['reflar.doorman.allowPublic'];\n\n        this.doorkey = {\n            key: Stream(this.generateRandomKey()),\n            groupId: Stream(3),\n            maxUses: Stream(10),\n            activates: Stream(false),\n        };\n    }\n\n    view() {\n        return (\n            <div className=\"container Doorkey-container\">\n                <h1>Doorman</h1>\n                {this.loading ? <LoadingIndicator /> : ''}\n                <div className=\"Doorkeys-title\">\n                    <h2>{app.translator.trans('fof-doorman.admin.page.doorkey.title')}</h2>\n                    <div className=\"helpText\">{app.translator.trans('fof-doorman.admin.page.doorkey.help.key')}</div>\n                    <div className=\"helpText\">{app.translator.trans('fof-doorman.admin.page.doorkey.help.group')}</div>\n                    <div className=\"helpText\">{app.translator.trans('fof-doorman.admin.page.doorkey.help.max')}</div>\n                    <div className=\"helpText\">{app.translator.trans('fof-doorman.admin.page.doorkey.help.activates')}</div>\n                </div>\n                <div className=\"Doorkeys-fieldLabels\">\n                    <h3 className=\"key\">{app.translator.trans('fof-doorman.admin.page.doorkey.heading.key')}</h3>\n                    <h3 className=\"group\">{app.translator.trans('fof-doorman.admin.page.doorkey.heading.group')}</h3>\n                    <h3 className=\"maxUses\">{app.translator.trans('fof-doorman.admin.page.doorkey.heading.max_uses')}</h3>\n                    <h3 className=\"activate\">{app.translator.trans('fof-doorman.admin.page.doorkey.heading.activate')}</h3>\n                </div>\n                <div className=\"Doorkeys\">\n                    {this.doorkeys.map((doorkey) => {\n                        return DoormanSettingsListItem.component({ doorkey, doorkeys: this.doorkeys });\n                    })}\n                </div>\n                <div className=\"Doorkeys-new\">\n                    <div className=\"Doorkeys-newInputs\">\n                        <input\n                            className=\"FormControl Doorkey-key\"\n                            type=\"text\"\n                            value={this.doorkey.key()}\n                            placeholder={app.translator.trans('fof-doorman.admin.page.doorkey.key')}\n                            oninput={withAttr('value', this.doorkey.key)}\n                        />\n                        {Select.component({\n                            options: this.getGroupsForInput(),\n                            className: 'Doorkey-select',\n                            onchange: this.doorkey.groupId,\n                            value: this.doorkey.groupId(),\n                        })}\n                        <input\n                            className=\"FormControl Doorkey-maxUses\"\n                            value={this.doorkey.maxUses()}\n                            type=\"number\"\n                            placeholder={app.translator.trans('fof-doorman.admin.page.doorkey.max_uses')}\n                            oninput={withAttr('value', this.doorkey.maxUses)}\n                        />\n                        {Switch.component({\n                            state: this.doorkey.activates() || false,\n                            onchange: this.doorkey.activates,\n                            className: 'Doorkey-switch',\n                        })}\n                    </div>\n                    {Button.component({\n                        type: 'button',\n                        className: 'Button Button--warning Doorkey-button',\n                        icon: 'fa fa-plus',\n                        onclick: this.createDoorkey.bind(this),\n                    })}\n                </div>\n                <div className=\"Doorkey-allowPublic\">\n                    <h2>{app.translator.trans('fof-doorman.admin.page.doorkey.allow-public.title')}</h2>\n                    {this.switcherLoading ? (\n                        <LoadingIndicator />\n                    ) : (\n                        <Switch state={this.isOptional} onchange={this.toggleOptional.bind(this)} className=\"AllowPublic-switch\">\n                            {app.translator.trans('fof-doorman.admin.page.doorkey.allow-public.switch-label')}\n                        </Switch>\n                    )}\n                </div>\n            </div>\n        );\n    }\n\n    getGroupsForInput() {\n        let options = [];\n\n        app.store.all('groups').map((group) => {\n            if (group.nameSingular() === 'Guest') {\n                return;\n            }\n            options[group.id()] = group.nameSingular();\n        });\n\n        return options;\n    }\n\n    generateRandomKey() {\n        return Array(8 + 1)\n            .join((Math.random().toString(36) + '00000000000000000').slice(2, 18))\n            .slice(0, 8);\n    }\n\n    createDoorkey() {\n        app.store\n            .createRecord('doorkeys')\n            .save({\n                key: this.doorkey.key(),\n                groupId: this.doorkey.groupId(),\n                maxUses: this.doorkey.maxUses(),\n                activates: this.doorkey.activates(),\n            })\n            .then((doorkey) => {\n                this.doorkey.key(this.generateRandomKey());\n                this.doorkey.groupId(3);\n                this.doorkey.maxUses(10);\n                this.doorkey.activates('');\n                this.doorkeys.push(doorkey);\n                m.redraw();\n            });\n    }\n\n    toggleOptional() {\n        this.switcherLoading = true;\n        const settings = {\n            'reflar.doorman.allowPublic': JSON.stringify(!this.isOptional),\n        };\n        saveSettings(settings)\n            .then(() => {\n                this.isOptional = JSON.parse(app.data.settings['reflar.doorman.allowPublic']);\n            })\n            .catch(() => {})\n            .then(() => {\n                this.switcherLoading = false;\n                m.redraw();\n            });\n    }\n}\n","import app from 'flarum/app';\nimport addSettingsPage from './addSettingsPage';\nimport Doorkey from './models/Doorkey';\n\napp.initializers.add('reflar-doorman', () => {\n    app.store.models.doorkeys = Doorkey;\n\n    addSettingsPage();\n});\n","import Model from 'flarum/Model';\nimport mixin from 'flarum/utils/mixin';\n\nexport default class Doorkey extends mixin(Model, {\n    id: Model.attribute('id'),\n    key: Model.attribute('key'),\n    groupId: Model.attribute('groupId'),\n    maxUses: Model.attribute('maxUses'),\n    uses: Model.attribute('uses'),\n    activates: Model.attribute('activates'),\n}) {\n    apiEndpoint() {\n        return `/reflar/doorkeys${this.exists ? `/${this.data.id}` : ''}`;\n    }\n}\n","module.exports = flarum.core.compat['Component'];","module.exports = flarum.core.compat['Model'];","module.exports = flarum.core.compat['app'];","module.exports = flarum.core.compat['components/AdminLinkButton'];","module.exports = flarum.core.compat['components/AdminNav'];","module.exports = flarum.core.compat['components/Alert'];","module.exports = flarum.core.compat['components/Badge'];","module.exports = flarum.core.compat['components/Button'];","module.exports = flarum.core.compat['components/LoadingIndicator'];","module.exports = flarum.core.compat['components/Modal'];","module.exports = flarum.core.compat['components/Page'];","module.exports = flarum.core.compat['components/Select'];","module.exports = flarum.core.compat['components/Switch'];","module.exports = flarum.core.compat['extend'];","module.exports = flarum.core.compat['utils/Stream'];","module.exports = flarum.core.compat['utils/mixin'];","module.exports = flarum.core.compat['utils/saveSettings'];","module.exports = flarum.core.compat['utils/withAttr'];"],"sourceRoot":""}