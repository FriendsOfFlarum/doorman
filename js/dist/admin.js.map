{"version":3,"file":"admin.js","mappings":"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","sources":["webpack://@fof/doorman/webpack/bootstrap","webpack://@fof/doorman/webpack/runtime/compat get default export","webpack://@fof/doorman/webpack/runtime/define property getters","webpack://@fof/doorman/webpack/runtime/hasOwnProperty shorthand","webpack://@fof/doorman/webpack/runtime/make namespace object","webpack://@fof/doorman/external root \"flarum.core.compat['admin/app']\"","webpack://@fof/doorman/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@fof/doorman/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@fof/doorman/external root \"flarum.core.compat['common/Model']\"","webpack://@fof/doorman/external root \"flarum.core.compat['common/utils/mixin']\"","webpack://@fof/doorman/./src/admin/models/Doorkey.js","webpack://@fof/doorman/external root \"flarum.core.compat['admin/components/ExtensionPage']\"","webpack://@fof/doorman/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@fof/doorman/external root \"flarum.core.compat['common/Component']\"","webpack://@fof/doorman/external root \"flarum.core.compat['common/components/Button']\"","webpack://@fof/doorman/external root \"flarum.core.compat['common/components/Badge']\"","webpack://@fof/doorman/external root \"flarum.core.compat['common/components/Select']\"","webpack://@fof/doorman/external root \"flarum.core.compat['common/components/Switch']\"","webpack://@fof/doorman/external root \"flarum.core.compat['common/components/Alert']\"","webpack://@fof/doorman/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@fof/doorman/./src/admin/components/InviteCodeModal.js","webpack://@fof/doorman/external root \"flarum.core.compat['common/utils/withAttr']\"","webpack://@fof/doorman/./src/admin/components/DoormanSettingsListItem.js","webpack://@fof/doorman/external root \"flarum.core.compat['admin/utils/saveSettings']\"","webpack://@fof/doorman/external root \"flarum.core.compat['common/utils/Stream']\"","webpack://@fof/doorman/./src/admin/components/SettingsPage.js","webpack://@fof/doorman/./src/admin/index.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['admin/app'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/mixin'];","import Model from 'flarum/common/Model';\nimport mixin from 'flarum/common/utils/mixin';\n\nexport default class Doorkey extends mixin(Model, {\n  id: Model.attribute('id'),\n  key: Model.attribute('key'),\n  groupId: Model.attribute('groupId'),\n  maxUses: Model.attribute('maxUses'),\n  uses: Model.attribute('uses'),\n  activates: Model.attribute('activates'),\n}) {\n  apiEndpoint() {\n    return `/fof/doorkeys${this.exists ? `/${this.data.id}` : ''}`;\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['admin/components/ExtensionPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Badge'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Select'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Switch'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Alert'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Modal'];","import app from 'flarum/admin/app';\nimport Alert from 'flarum/common/components/Alert';\nimport Modal from 'flarum/common/components/Modal';\nimport Button from 'flarum/common/components/Button';\n\nexport default class InviteCodeModal extends Modal {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.emails = [];\n\n    this.doorkey = this.attrs.doorkey;\n\n    this.success = false;\n  }\n\n  className() {\n    return 'InviteCodeModal Modal--small';\n  }\n\n  title() {\n    return app.translator.trans('fof-doorman.admin.modal.title');\n  }\n\n  oncreate(vnode) {\n    super.oncreate(vnode);\n    $('#EmailInput')\n      .off()\n      .on('keydown', (e) => {\n        if (e.keyCode === 13 || e.keyCode === 188 || e.keyCode === 32) {\n          e.preventDefault();\n          this.addEmails();\n        }\n      });\n  }\n\n  onremove(vnode) {\n    super.onremove(vnode);\n    app.alerts.dismiss(this.alert);\n  }\n\n  content() {\n    return (\n      <div className=\"Modal-body\">\n        <h3>\n          {app.translator.trans('fof-doorman.admin.modal.group', {\n            group: app.store.getById('groups', this.doorkey.groupId()).nameSingular(),\n          })}\n        </h3>\n        <div className=\"helpText\">{app.translator.trans('fof-doorman.admin.modal.help')}</div>\n        <div className=\"Form Form--centered\">\n          <div className=\"Form-group\">\n            <input\n              type=\"text\"\n              name=\"text\"\n              id=\"EmailInput\"\n              className=\"FormControl\"\n              placeholder={app.translator.trans('fof-doorman.admin.modal.placeholder')}\n              disabled={this.loading}\n            />\n          </div>\n          <div className=\"Form-group\">\n            <ul>\n              {this.emails.map((email, i) => {\n                return (\n                  <li className=\"emailListItem\">\n                    <p>{email}</p>\n                    {Button.component({\n                      className: 'Button',\n                      loading: this.loading,\n                      icon: 'fas fa-times',\n                      onclick: this.removeEmail.bind(this, i),\n                    })}\n                  </li>\n                );\n              })}\n            </ul>\n          </div>\n          <div className=\"Form-group\">\n            {Button.component(\n              {\n                className: 'Button Button--primary Button--block',\n                loading: this.loading,\n                onclick: this.send.bind(this),\n                disabled: this.emails.length === 0,\n              },\n              app.translator.trans('fof-doorman.admin.modal.send')\n            )}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  addEmails() {\n    app.alerts.dismiss(this.alert);\n    m.redraw();\n    this.badEmails = [];\n\n    const value = $('#EmailInput').val();\n\n    value.split(/[ ,]+/).map((email) => {\n      if (!this.emails.includes(email)) {\n        if (this.emails.length + 1 > this.doorkey.data.attributes.maxUses) {\n          this.alert = app.alerts.show(Alert, { type: 'error' }, app.translator.trans('fof-doorman.admin.modal.max_use_conflict'));\n          m.redraw();\n        } else {\n          if (this.validateEmail(email)) {\n            this.emails.push(email);\n            $('#EmailInput').val('');\n            m.redraw();\n          } else {\n            this.badEmails.push(email);\n            this.alert = app.alerts.show(\n              Alert,\n              { type: 'error' },\n              app.translator.trans('fof-doorman.admin.modal.invalid_emails', { emails: this.badEmails.join(', ') })\n            );\n            m.redraw();\n          }\n        }\n      }\n    });\n  }\n\n  validateEmail(email) {\n    const re =\n      /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n    return re.test(String(email).toLowerCase());\n  }\n\n  removeEmail(i) {\n    this.emails.splice(i, 1);\n  }\n\n  send(e) {\n    e.preventDefault();\n\n    app.alerts.dismiss(this.alert);\n\n    this.loading = true;\n\n    app\n      .request({\n        method: 'POST',\n        url: app.forum.attribute('apiUrl') + '/fof/doorkeys/invites',\n        body: {\n          emails: this.emails,\n          doorkeyId: this.doorkey.data.id,\n        },\n      })\n      .then(() => {\n        app.modal.close();\n        this.alert = app.alerts.show(Alert, { type: 'success' }, app.translator.trans('fof-doorman.admin.modal.success'));\n      });\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/withAttr'];","import app from 'flarum/admin/app';\nimport Component from 'flarum/common/Component';\nimport Button from 'flarum/common/components/Button';\nimport Badge from 'flarum/common/components/Badge';\nimport Select from 'flarum/common/components/Select';\nimport Switch from 'flarum/common/components/Switch';\nimport InviteCodeModal from './InviteCodeModal';\nimport withAttr from 'flarum/common/utils/withAttr';\n\nexport default class DoormanSettingsListItem extends Component {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.doorkey = this.attrs.doorkey;\n    this.doorkeys = this.attrs.doorkeys;\n  }\n\n  view() {\n    var remaining = this.doorkey.maxUses() - this.doorkey.uses();\n\n    return (\n      <div className=\"DoormanSettingsListItem\">\n        <div className=\"DoormanSettingsListItem-inputs\">\n          <input\n            className=\"FormControl Doorkey-key\"\n            type=\"text\"\n            disabled\n            value={this.doorkey.key()}\n            placeholder={app.translator.trans('fof-doorman.admin.page.doorkey.key')}\n            onchange={withAttr('value', this.updateKey.bind(this, this.doorkey))}\n          />\n          {Select.component({\n            options: this.getGroupsForInput(),\n            className: 'Doorkey-select',\n            onchange: this.updateGroupId.bind(this, this.doorkey),\n            value: this.doorkey.groupId() || 3,\n          })}\n          <input\n            className=\"FormControl Doorkey-maxUses\"\n            value={this.doorkey.maxUses() || '0'}\n            type=\"number\"\n            placeholder={app.translator.trans('fof-doorman.admin.page.doorkey.max_uses')}\n            onchange={withAttr('value', this.updateMaxUses.bind(this, this.doorkey))}\n          />\n          {Switch.component({\n            state: this.doorkey.activates() || false,\n            onchange: this.updateActivates.bind(this, this.doorkey),\n            className: 'Doorkey-switch',\n          })}\n        </div>\n\n        {Button.component({\n          type: 'button',\n          className: 'Button Button--warning Doorkey-button',\n          icon: 'fa fa-envelope',\n          onclick: this.showModal.bind(this),\n        })}\n\n        {Button.component({\n          type: 'button',\n          className: 'Button Button--warning Doorkey-button',\n          icon: 'fa fa-times',\n          onclick: this.deleteDoorkey.bind(this, this.doorkey),\n        })}\n\n        {this.doorkey.maxUses() === this.doorkey.uses() ? (\n          Badge.component({\n            className: 'Doorkey-badge',\n            icon: 'fas fa-user-slash',\n            label: app.translator.trans('fof-doorman.admin.page.doorkey.warning'),\n          })\n        ) : (\n          <div>\n            <h3 className=\"Doorkey-left\">{app.translator.trans('fof-doorman.admin.page.doorkey.used_times', { remaining })}</h3>\n          </div>\n        )}\n      </div>\n    );\n  }\n\n  showModal() {\n    app.modal.show(InviteCodeModal, { doorkey: this.doorkey });\n  }\n\n  getGroupsForInput() {\n    let options = [];\n\n    app.store.all('groups').map((group) => {\n      if (group.nameSingular() === 'Guest') {\n        return;\n      }\n      options[group.id()] = group.nameSingular();\n    });\n\n    return options;\n  }\n\n  updateKey(doorkey, key) {\n    doorkey.save({ key });\n  }\n\n  updateGroupId(doorkey, groupId) {\n    doorkey.save({ groupId });\n  }\n\n  updateMaxUses(doorkey, maxUses) {\n    doorkey.save({ maxUses });\n  }\n\n  updateActivates(doorkey, activates) {\n    doorkey.save({ activates });\n  }\n\n  deleteDoorkey(doorkeyToDelete) {\n    doorkeyToDelete.delete();\n    this.doorkeys.some((doorkey, i) => {\n      if (doorkey.data.id === doorkeyToDelete.data.id) {\n        this.doorkeys.splice(i, 1);\n        return true;\n      }\n    });\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['admin/utils/saveSettings'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/Stream'];","import ExtensionPage from 'flarum/admin/components/ExtensionPage';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport DoormanSettingsListItem from './DoormanSettingsListItem';\nimport Button from 'flarum/common/components/Button';\nimport Select from 'flarum/common/components/Select';\nimport Switch from 'flarum/common/components/Switch';\nimport app from 'flarum/admin/app';\nimport saveSettings from 'flarum/admin/utils/saveSettings';\nimport Stream from 'flarum/common/utils/Stream';\nimport withAttr from 'flarum/common/utils/withAttr';\n\nexport default class DoormanSettingsPage extends ExtensionPage {\n  oninit(vnode) {\n    super.oninit(vnode);\n\n    this.loading = false;\n    this.switcherLoading = false;\n    this.doorkeys = app.store.all('doorkeys');\n    this.isOptional = app.data.settings['fof-doorman.allowPublic'];\n\n    this.doorkey = {\n      key: Stream(this.generateRandomKey()),\n      groupId: Stream(3),\n      maxUses: Stream(10),\n      activates: Stream(false),\n    };\n  }\n\n  content() {\n    return (\n      <div className=\"container Doorkey-container\">\n        {this.loading ? <LoadingIndicator /> : ''}\n        <div className=\"Doorkeys-title\">\n          <h2>{app.translator.trans('fof-doorman.admin.page.doorkey.title')}</h2>\n          <div className=\"helpText\">{app.translator.trans('fof-doorman.admin.page.doorkey.help.key')}</div>\n          <div className=\"helpText\">{app.translator.trans('fof-doorman.admin.page.doorkey.help.group')}</div>\n          <div className=\"helpText\">{app.translator.trans('fof-doorman.admin.page.doorkey.help.max')}</div>\n          <div className=\"helpText\">{app.translator.trans('fof-doorman.admin.page.doorkey.help.activates')}</div>\n        </div>\n        <div className=\"Doorkeys-fieldLabels\">\n          <h3 className=\"key\">{app.translator.trans('fof-doorman.admin.page.doorkey.heading.key')}</h3>\n          <h3 className=\"group\">{app.translator.trans('fof-doorman.admin.page.doorkey.heading.group')}</h3>\n          <h3 className=\"maxUses\">{app.translator.trans('fof-doorman.admin.page.doorkey.heading.max_uses')}</h3>\n          <h3 className=\"activate\">{app.translator.trans('fof-doorman.admin.page.doorkey.heading.activate')}</h3>\n        </div>\n        <div className=\"Doorkeys\">\n          {this.doorkeys.map((doorkey) => {\n            return DoormanSettingsListItem.component({ doorkey, doorkeys: this.doorkeys });\n          })}\n        </div>\n        <div className=\"Doorkeys-new\">\n          <div className=\"Doorkeys-newInputs\">\n            <input\n              className=\"FormControl Doorkey-key\"\n              type=\"text\"\n              value={this.doorkey.key()}\n              placeholder={app.translator.trans('fof-doorman.admin.page.doorkey.key')}\n              oninput={withAttr('value', this.doorkey.key)}\n            />\n            {Select.component({\n              options: this.getGroupsForInput(),\n              className: 'Doorkey-select',\n              onchange: this.doorkey.groupId,\n              value: this.doorkey.groupId(),\n            })}\n            <input\n              className=\"FormControl Doorkey-maxUses\"\n              value={this.doorkey.maxUses()}\n              type=\"number\"\n              placeholder={app.translator.trans('fof-doorman.admin.page.doorkey.max_uses')}\n              oninput={withAttr('value', this.doorkey.maxUses)}\n              min=\"0\"\n            />\n            {Switch.component({\n              state: this.doorkey.activates() || false,\n              onchange: this.doorkey.activates,\n              className: 'Doorkey-switch',\n            })}\n          </div>\n          {Button.component({\n            type: 'button',\n            className: 'Button Button--warning Doorkey-button',\n            icon: 'fa fa-plus',\n            onclick: this.createDoorkey.bind(this),\n          })}\n        </div>\n        <div className=\"Doorkey-allowPublic\">\n          <h2>{app.translator.trans('fof-doorman.admin.page.doorkey.allow-public.title')}</h2>\n          {this.switcherLoading ? (\n            <LoadingIndicator />\n          ) : (\n            <Switch state={this.isOptional} onchange={this.toggleOptional.bind(this)} className=\"AllowPublic-switch\">\n              {app.translator.trans('fof-doorman.admin.page.doorkey.allow-public.switch-label')}\n            </Switch>\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  getGroupsForInput() {\n    let options = [];\n\n    app.store.all('groups').map((group) => {\n      if (group.nameSingular() === 'Guest') {\n        return;\n      }\n      options[group.id()] = group.nameSingular();\n    });\n\n    return options;\n  }\n\n  generateRandomKey() {\n    return Array(8 + 1)\n      .join((Math.random().toString(36) + '00000000000000000').slice(2, 18))\n      .slice(0, 8);\n  }\n\n  createDoorkey() {\n    app.store\n      .createRecord('doorkeys')\n      .save({\n        key: this.doorkey.key(),\n        groupId: this.doorkey.groupId(),\n        maxUses: this.doorkey.maxUses(),\n        activates: this.doorkey.activates(),\n      })\n      .then((doorkey) => {\n        this.doorkey.key(this.generateRandomKey());\n        this.doorkey.groupId(3);\n        this.doorkey.maxUses(10);\n        this.doorkey.activates('');\n        this.doorkeys.push(doorkey);\n        m.redraw();\n      });\n  }\n\n  toggleOptional() {\n    this.switcherLoading = true;\n    const settings = {\n      'fof-doorman.allowPublic': !this.isOptional,\n    };\n    saveSettings(settings)\n      .then(() => {\n        this.isOptional = JSON.parse(app.data.settings['fof-doorman.allowPublic']);\n      })\n      .catch(() => {})\n      .then(() => {\n        this.switcherLoading = false;\n        m.redraw();\n      });\n  }\n}\n","import app from 'flarum/admin/app';\nimport Doorkey from './models/Doorkey';\nimport SettingsPage from './components/SettingsPage';\n\napp.initializers.add('fof-doorman', () => {\n  app.store.models.doorkeys = Doorkey;\n\n  app.extensionData.for('fof-doorman').registerPage(SettingsPage);\n});\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","core","compat","_setPrototypeOf","p","setPrototypeOf","__proto__","_inheritsLoose","subClass","superClass","create","constructor","Doorkey","apiEndpoint","this","exists","data","id","mixin","Model","groupId","maxUses","uses","activates","InviteCodeModal","oninit","vnode","emails","doorkey","attrs","success","className","title","app","oncreate","$","off","on","e","keyCode","preventDefault","addEmails","onremove","alert","content","group","nameSingular","type","name","placeholder","disabled","loading","map","email","i","Button","icon","onclick","removeEmail","bind","send","length","m","redraw","badEmails","val","split","includes","attributes","Alert","validateEmail","push","join","test","String","toLowerCase","splice","method","url","body","doorkeyId","then","Modal","DoormanSettingsListItem","doorkeys","view","remaining","onchange","withAttr","updateKey","Select","options","getGroupsForInput","updateGroupId","updateMaxUses","Switch","state","updateActivates","showModal","deleteDoorkey","Badge","label","save","doorkeyToDelete","some","Component","DoormanSettingsPage","switcherLoading","isOptional","Stream","generateRandomKey","component","oninput","min","createDoorkey","toggleOptional","Array","Math","random","toString","slice","settings","saveSettings","JSON","parse","ExtensionPage","registerPage","SettingsPage"],"sourceRoot":""}